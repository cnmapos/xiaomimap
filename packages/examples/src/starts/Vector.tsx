import {
  createViewer,
  HZViewer,
  LineEntity,
  PointEntity,
  PolygonEntity,
} from '@hztx/core';
import React, { useEffect, useRef } from 'react';
import MapContainer from '../components/map-container';

function Vector() {
  const container = useRef<HTMLElement | null>();
  const context = useRef<{ viewer: HZViewer | null }>({ viewer: null });

  useEffect(() => {
    const viewer = createViewer(container.current!, {
      key: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI5YjliYjIwYi0zMWE0LTQ4MTgtYWU4NC0wNWZmNTFmZjVhYmMiLCJpZCI6MjY1NzYxLCJpYXQiOjE3MzU1NzA3MTl9.BOJDK-WqsLV-QcQhbnAEf-wG1mtkftG1BYV6JIv0VoI',
    });
    context.current.viewer = viewer;

    const point = new PointEntity({
      positions: [116.32821170576749, 42.66542575152765],
    });
    viewer.addEntity(point);

    const line = new LineEntity({
      positions: [
        [105.90946813913673, 31.010576149982967],
        [105.90490464353299, 31.002982407335345],
        [105.9008803680608, 30.99372685226692],
        [105.89793840319732, 30.988148214996627],
        [105.8964778226053, 30.98483471965677],
        [105.89139302013811, 30.98163366576711],
        [105.8872069231659, 30.980836094054286],
        [105.88114853239549, 30.980916062652987],
        [105.87734037522658, 30.982280245554676],
        [105.87520548563039, 30.98537592206136],
        [105.87369422788869, 30.988702300169138],
        [105.87317141627207, 30.993337544408156],
        [105.87238586414354, 30.997550550039872],
      ],
    });
    viewer.addEntity(line);

    const polygon = new PolygonEntity({
      positions: [
        [105.89300187853127, 30.98508205254971],
        [105.89330656163577, 30.984096267743304],
        [105.893176502174, 30.983442386313126],
        [105.89266648065123, 30.983492632448467],
        [105.89240137552737, 30.982945535462925],
        [105.89156216536516, 30.983305620104485],
        [105.89192625555671, 30.983672209247914],
        [105.89185148041547, 30.984265810349502],
        [105.89135263284878, 30.985069913605948],
        [105.89088332954829, 30.98523771912611],
        [105.890092405327, 30.985139274177868],
        [105.89015754250347, 30.98566822472512],
        [105.88986139931858, 30.98582727818328],
        [105.88952533380608, 30.986599727021282],
        [105.8887048753959, 30.986612091102188],
        [105.8880662756159, 30.986627427089314],
        [105.887288685963, 30.987470643941503],
        [105.88805291855049, 30.988279296129356],
        [105.89076958434487, 30.987417268578678],
        [105.89249324635564, 30.989070386259797],
        [105.89376447967074, 30.988907493994],
        [105.89424168418542, 30.98867663787145],
        [105.89528142412243, 30.988369485003567],
        [105.896111091862, 30.98852351251135],
        [105.89663634262148, 30.988265923303285],
        [105.89567102056243, 30.987545563543712],
        [105.89465706873875, 30.987769443820156],
        [105.89375946394524, 30.987971732063727],
        [105.89284308425, 30.988031216679264],
        [105.89208767073717, 30.987602673876978],
        [105.89143978545819, 30.986931031923692],
        [105.89147055999403, 30.986116679738807],
        [105.89221145093471, 30.98586150207984],
        [105.89211606205255, 30.985249902110017],
      ],
    });
    viewer.addEntity(polygon);

    viewer.entities.remove(polygon);

    return () => {
      viewer.destroy();
    };
  }, []);

  return (
    <MapContainer>
      <div
        ref={(e) => (container.current = e)}
        style={{ width: '100%', height: '100%' }}
        id="map"
      ></div>
      <div>
        <div className="hz-player">
          <div></div>
          <div></div>
        </div>
        <div className="hz-style"></div>
      </div>
    </MapContainer>
  );
}

export default Vector;
